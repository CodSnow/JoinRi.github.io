<html>
<head>
  <title>Kafka</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600753 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>

<a href="../HD_index.html">首页</a>
<a name="550"/>
<h1>Kafka</h1>

<div>
<span><div><div><div><font style="font-size: 16pt;"><span style="font-size: 16pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;; font-weight: bold;">Kafka</span><span style="font-size: 16pt; color: black; font-family: 华文细黑; font-weight: bold;">简介</span></font></div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">    <span style="font-size: 14pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;; font-weight: bold;">Kafka</span></span><span style="font-size: 14pt; color: black; font-family: 华文细黑; font-weight: bold;">定义：</span></font></div><div><span style="font-size: 10pt;"><span style="font-size: 10pt; color: black; font-family: 华文细黑;">        Kafka</span></span> <span style="font-size: 10pt; color: black; font-family: 华文细黑;">是一个高吞吐、分布式、基于发布订阅的</span><font style="font-size: 11pt;"><span style="font-size: 11pt; font-family: 华文细黑; font-weight: bold;">消息系统</span></font><span style="font-size: 10pt; font-family: 华文细黑;"><span style="font-size: 10pt; font-family: 华文细黑; font-weight: bold;">，</span>利用</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Kafka</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">技术可在廉价</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">PC Server</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">上搭建起大规模消息系统。</span></div><div><span style="font-size: 10pt; font-family: 华文细黑;">                    Kafka是一个分布式的、分区的、多副本的消息发布-订阅系统，它提供了类似于JMS的特性，但在设计上完全不同，它具有消息持久化、高吞吐、分布式、多客户端支持、实时等特性，适用于离线和在线                的消息消费，如常规的消息收集、网站活性跟踪、聚合统计系统运营数据（监控数据）、日志收集等大量数据的互联网服务的数据收集场景。</span></div><div><span style="font-size: 10pt; font-family: 华文细黑;">                </span></div><div><span style="font-size: 10pt; font-family: 华文细黑;">                        注：</span></div><ul><ul><ul><li><div><span style="font-size: 11pt; color: black; font-family: 华文细黑;">由</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">LinkedIn</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">开发，并于</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">2011</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">年开源。</span></div></li><li><div><span style="font-size: 11pt; color: black; font-family: 华文细黑; font-weight: bold;">使用</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;; font-weight: bold;">Scala</span><span style="font-size: 11pt; color: black; font-family: 华文细黑; font-weight: bold;">、</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;; font-weight: bold;">Java</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;"><span style="font-size: 11pt; color: black; font-family: 华文细黑; font-weight: bold;">语言实现</span>。</span></div></li><li><div><span style="font-size: 11pt; color: black; font-family: 华文细黑;">在</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">LinkedIn</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">中，用作活动流和运营数据处理管道的基础。</span></div></li><li><div><span style="font-size: 11pt; color: black; font-family: 华文细黑;">现在已经被多家不同公司作为多种类型的数据管道和消息系统使用。</span></div></li></ul></ul></ul><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-family: &quot;FrutigerNext LT Medium&quot;; font-weight: bold;">    Kafka</span><span style="font-size: 12pt; font-family: 黑体; font-weight: bold;">在</span><span style="font-size: 12pt; font-family: &quot;FrutigerNext LT Medium&quot;; font-weight: bold;">FusionInsight</span><span style="font-size: 12pt; font-family: 黑体; font-weight: bold;">中的位置</span></font></div><div><br/></div><div style="text-align: left;"><font style="font-size: 12pt;"><span style="font-size: 12pt; font-family: 黑体; font-weight: bold;">        </span></font><span style="font-size: 12pt;"><span style="font-size: 12pt; font-family: 黑体; font-weight: bold;"><img src="Kafka_files/Image.png" type="image/png" data-filename="Image.png" width="403"/></span></span></div><div style="text-align: left;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: left;"><span style="font-size: 12pt;"><br/></span></div><div><br/></div><div><font style="font-size: 16pt;"><span style="font-size: 16pt; font-family: &quot;FrutigerNext LT Regular&quot;; font-weight: bold;">Kafka</span><span style="font-size: 16pt; font-family: 华文细黑; font-weight: bold;">架构与功能</span></font></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(127, 127, 127); font-family: 华文细黑; font-weight: bold;">        </span></font><span style="font-size: 10pt; font-family: 华文细黑;">Kafka是一个分布式、分区化、多副本的消息发布-订阅系统。生产者（Producer）将消息发布到Kafka主题（Topic），消费者（Consumer）订阅这些主题并消费这些消息。在Kafka集群上一个服务器称为一个Broker。对于每一个主题，Kafka集群保留一个用于缩放、并行化和容错性的分区（Partition）。每个分区是一个有序、不可变的消息序列，并不断追加到提交日志文件。分区的消息每个也被赋值一个称为偏移顺序（Offset）的序列化编号。</span></div><div>        <img src="Kafka_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>       <span style="font-weight: bold;"> </span> <span style="font-weight: bold;">Kafka模块间关系</span></div><div>                        <img src="Kafka_files/Image [2].png" type="image/png" data-filename="Image.png"/></div><div>       <span style="font-weight: bold;"> </span><span style="font-weight: bold;">    原理：</span></div><div><span style="font-weight: bold;">                1.</span><span style="font-weight: bold;">消息可靠性：</span></div><div style="margin-left: 80px;"><span style="font-weight: bold;">    </span><span style="font-weight: bold;">  </span> Kafka Broker收到消息后，会持久化到磁盘，同时，Topic的每个Partition有自己的Replica（备份），每个Replica分布在不同的Broker节点上，以保证当某一节点失效时，可以自动故障转移到可用消息节点。</div><div>               <span style="font-weight: bold;"> 2.</span><span style="font-weight: bold;">高吞吐量</span></div><div><span style="font-weight: bold;">                        </span><span style="font-weight: bold;">Kafka通过以下方式提供系统高吞吐量：</span></div><ul><ul><ul><li><div><b>数据磁盘持久化</b>：消息不在内存中cache，直接写入到磁盘，充分利用磁盘的顺序读写性能。</div></li><li><div>Zero-copy：减少IO操作步骤。</div></li><li><div>数据批量发送：提高网络利用率。</div></li><li><div>Topic划分为多个Partition，提高并发度，可以由多个Producer、Consumer数目之间的关系并发来读、写消息。Producer根据用户指定的算法，将消息发送到指定的Partition。</div></li></ul></ul></ul><div><br/></div><div>            <span style="font-weight: bold;">    3.</span><span style="font-weight: bold;">消息订阅-通知机制</span></div><div><span style="font-weight: bold;">               4. </span><span style="font-weight: bold;">可扩展性</span></div><div><br/></div><div><span style="font-weight: bold;">        开源特性：</span></div><div style="margin-left: 40px;"><span style="font-weight: bold;">1.</span><span style="font-weight: bold;">可靠性：</span></div><div style="margin-left: 80px;"><span style="font-weight: bold;">提供At-Least Once，At-Most Once，Exactly Once消息可靠传递。消息被处理的状态是在Consumer端维护，需要结合应用层实现Exactly Once。</span></div><div style="margin-left: 40px;"><span style="font-weight: bold;">2.高吞吐</span></div><div style="margin-left: 80px;"><span style="font-weight: bold;">同时为发布和订阅提供高吞吐量。</span></div><div style="margin-left: 40px;"><span style="font-weight: bold;">3.持久化</span></div><div style="margin-left: 80px;"><span style="font-weight: bold;">将消息持久化到磁盘，因此可用于批量消费，以及实时应用程序。通过将数据持久化到硬盘以及replication防止数据丢失。</span></div><div style="margin-left: 40px;"><span style="font-weight: bold;">4.分布式</span></div><div style="margin-left: 80px;"><span style="font-weight: bold;">分布式系统，易于向外扩展。所有的Producer、Broker和Consumer都支持部署多个形成分布式的集群。无需停机即可扩展系统。</span></div><div><span style="font-weight: bold;">                    </span></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; font-family: &quot;FrutigerNext LT Medium&quot;; font-weight: bold;">    Kafka</span><span style="font-size: 14pt; font-family: 黑体; font-weight: bold;">拓扑结构图</span></font></div><div><br/></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-family: 黑体; font-weight: bold;">        </span></font><span style="font-size: 12pt;"><span style="font-size: 12pt; font-family: 黑体; font-weight: bold;"><img src="Kafka_files/Image [3].png" type="image/png" data-filename="Image.png" width="308"/></span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-family: 黑体; font-weight: bold;">        注：</span></span></div><ul><ul><ul><li><div><span style="font-size: 11pt; color: black; font-family: 华文细黑;">一个典型的</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Kafka</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">集群中包含若干</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Producer</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">（可以是</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">web</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">前端产生的</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Page View</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">，或者是服务器日志，系统</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">CPU</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">、</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Memory</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">等），若干</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Broker</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">（</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Kafka</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">支持水平扩展，一般</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">broker</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">数量越多，集群吞吐率越高），若干</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Consumer</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">，以及一个</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Zookeeper</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">集群。</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Kafka</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">通过</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Zookeeper</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">管理集群配置，选举</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Leader</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">，以及在</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Consumer</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">发生变化时进行</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">rebalance</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">。</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Producer</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">使用</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">push</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">模式将消息发布到</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Broker</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">，</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Consumer</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">使用</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">pull</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">模式从</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Broker</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">订阅并消费消息。</span></div></li><li><div><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Broker</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">：</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Kafka</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">集群包含一个或多个服务实例，这</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">些</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">服务实例被称为</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Broker</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">。</span></div></li><li><div><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Producer</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">：负责发布消息到</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Kafka Broker</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">。</span></div></li><li><div><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Consumer</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">：消息消费者，</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">从</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Kafka Broker</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">读取消息的客户端。</span></div></li></ul></ul></ul><div><br/></div><div><br/></div><div><span style="font-size: 12pt; font-family: &quot;FrutigerNext LT Medium&quot;; font-weight: bold;"> <span style="font-size: 14pt; font-family: &quot;FrutigerNext LT Medium&quot;; font-weight: bold;">       </span></span><span style="font-size: 14pt; font-family: &quot;FrutigerNext LT Medium&quot;; font-weight: bold;">Kafka Topics（相当于某个类别的队列）</span></div><div><br/></div><div><span style="font-size: 12pt; font-family: &quot;FrutigerNext LT Medium&quot;; font-weight: bold;">            </span><span style="font-size: 12pt;"><span style="font-size: 12pt; font-family: &quot;FrutigerNext LT Medium&quot;; font-weight: bold;"><img src="Kafka_files/Image [4].png" type="image/png" data-filename="Image.png" width="484"/></span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-family: &quot;FrutigerNext LT Medium&quot;; font-weight: bold;">        </span></span></div><div><br/></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-family: &quot;FrutigerNext LT Medium&quot;; font-weight: bold;">            注：</span></span></div><ul><ul><ul><li><div><font style="font-size: 10pt;"><span style="font-size: 10pt; color: black; font-family: 华文细黑;">每条发布到</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Kafka</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">的消息都有一个类别，这个类别被称为</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Topic</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">，也可以理解为一个存储消息的队列。例如：天气作为一个</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Topic</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">，每天的温度消息就可以存储在“天气”这个队列里。</span></font></div></li><li><div><font style="font-size: 10pt;"><span style="font-size: 10pt; color: black; font-family: 华文细黑;">图片中的蓝色框为</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Kafka</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">的一个</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Topic</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">，即可以理解为一个(</span><span style="font-size: 10pt; color: rgb(255, 122, 116); font-family: 华文细黑;">主题)</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">队列，每个格子代表一条消息。生产者产生的消息逐条放到</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Topic</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">的末尾。消费者从左至右顺序读取消息，使用</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Offset</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">来记录读取的位置。</span></font></div></li></ul></ul></ul><div><span style="font-size: 12pt; font-family: &quot;FrutigerNext LT Medium&quot;; font-weight: bold;">    </span></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; font-family: 华文细黑; font-weight: bold;">        </span><span style="font-size: 14pt; font-family: &quot;FrutigerNext LT Medium&quot;; font-weight: bold;">Kafka Partition（</span><span style="font-size: 14pt; font-family: &quot;FrutigerNext LT Medium&quot;; font-weight: bold;">有序不可变</span><span style="font-size: 14pt; font-family: &quot;FrutigerNext LT Medium&quot;; font-weight: bold;">）</span></font></div><div><span style="font-size: 12pt; font-family: &quot;FrutigerNext LT Medium&quot;; font-weight: bold;">        </span></div><div><span style="font-size: 10pt; color: black; font-family: 华文细黑;">                每个</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Topic</span> <span style="font-size: 10pt; color: black; font-family: 华文细黑;">都有一个或者多个</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Partitions（分区）</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">构成。每个</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Partition</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">都是有</span><span style="font-size: 10pt; color: rgb(255, 122, 116); font-family: 华文细黑;">序且不可变的</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">消息队列。引入</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Partition</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">机制，保证了</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Kafka</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">的</span><span style="font-size: 10pt; color: rgb(255, 122, 116); font-family: 华文细黑;">高吞吐能力(</span><span style="font-size: 10pt; font-family: 华文细黑; font-weight: bold;">并发</span><span style="font-size: 10pt; color: rgb(255, 122, 116); font-family: 华文细黑;">)</span></div><div><br/></div><div style="text-align: center;"><font style="font-size: 10pt;"><span style="font-size: 10pt; color: rgb(255, 122, 116); font-family: 华文细黑;">                    </span><span style="font-size: 10pt; color: rgb(255, 122, 116); font-family: 华文细黑;">    </span><span style="font-size: 10pt; color: rgb(255, 122, 116); font-family: 华文细黑;">   </span></font> <span style="color: rgb(255, 122, 116); font-family: 华文细黑;"><img src="Kafka_files/Image [5].png" type="image/png" data-filename="Image.png" width="483"/></span></div><div><span style="font-family: 华文细黑;"><span style="font-family: 华文细黑; color: rgb(255, 122, 116);">    </span><span style="font-family: 华文细黑; color: rgb(255, 122, 116);">    </span><span style="font-family: 华文细黑; color: rgb(255, 122, 116);">    </span><span style="font-family: 华文细黑; color: rgb(255, 122, 116);">    </span><span style="font-family: 华文细黑; color: rgb(255, 122, 116);"> </span>  </span></div><div><span style="font-family: 华文细黑;">                         注：</span></div><ul><ul><ul><li><div><font style="font-size: 10pt;"><span style="font-size: 10pt; color: black; font-family: 华文细黑;">每个</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">topic</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">被分成多个</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">partition(</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">区</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">),</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">每个</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">partition</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">在存储层面对应一个</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">log</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">文件，</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">log</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">文件中记录了所有的消息数据。</span></font></div></li><li><div><font style="font-size: 10pt;"><span style="font-size: 10pt; color: black; font-family: 华文细黑;">引入</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Partition</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">机制，保证了</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Kafka</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">的高吞吐能力，因为</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Topic</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">的多个</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Partition</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">分布在不同的</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Kafka</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">节点上，这样一来多个客户端（</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Producer</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">和</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Consumer</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">）就可以并发访问不同的节点对一个</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Topic</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">进行消息的读写。</span></font></div></li></ul></ul></ul><div style="margin-left: 40px;"><div><font style="font-size: 10pt;"><span style="font-size: 10pt; color: black; font-family: 华文细黑;">                </span></font></div><div><span style="font-family: 华文细黑;">            <img src="Kafka_files/Image [6].png" type="image/png" data-filename="Image.png" width="406"/></span></div></div><ul><div style="margin-left: 80px;"><font style="font-size: 10pt;"><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Consumer group A</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">有两个消费者来读取</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">4</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">个</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Partition</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">中数据。</span></font></div><div style="margin-left: 80px;"><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Consumer</span> <span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">group B</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">有四个消费者来读取</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">4</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">个</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">partition</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">中数据。</span></div><div style="margin-left: 80px;"><font style="font-size: 10pt;"><span style="font-size: 10pt; color: black; font-family: 华文细黑;">    注：</span></font></div><ul><ul><ul><li><div><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Topic</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">的</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Partition</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">数量可以在创建时配置。</span></div></li><li><div><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Partition</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">数量决定了每个</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Consumer group</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">中并发消费者的最大数量。</span></div></li></ul></ul></ul></ul><div><span style="font-family: &quot;FrutigerNext LT Medium&quot;; font-weight: bold;"><span style="font-size: 12pt; font-family: &quot;FrutigerNext LT Medium&quot;; font-weight: bold;">  </span> <span style="font-size: 14pt; font-family: &quot;FrutigerNext LT Medium&quot;; font-weight: bold;"> </span><span style="font-size: 12pt; font-family: &quot;FrutigerNext LT Medium&quot;; font-weight: bold;">Kafka Partition</span></span><span style="font-size: 12pt; font-family: 黑体; font-weight: bold;">偏移量（</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">offset</span><span style="font-size: 12pt; font-family: 黑体; font-weight: bold;">）</span></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; color: black; font-family: 华文细黑;">            每条消息在文件中的位置称为</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">offset</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">（偏移量），</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">offset</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">是一个</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">long</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">型数字，它唯一标记一条消息。消费者通过（</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">offset</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">、</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">partition</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">、</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">topic</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">）跟踪记录。</span></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-family: 黑体; font-weight: bold;">        </span></font><span style="font-size: 12pt;"><span style="font-size: 12pt; font-family: 黑体; font-weight: bold;"><img src="Kafka_files/Image [7].png" type="image/png" data-filename="Image.png" width="367"/></span></span></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-family: &quot;FrutigerNext LT Medium&quot;; font-weight: bold;">    Kafka Partition</span><span style="font-size: 12pt; font-family: 黑体; font-weight: bold;">副本</span><span style="font-size: 12pt; font-family: 黑体; font-weight: bold;">（</span><span style="font-size: 12pt; font-family: 黑体;">一般是跟主设备进行交互，备负责同步</span><span style="font-size: 12pt; font-family: 黑体; font-weight: bold;">）</span><span style="font-size: 12pt; font-family: 黑体;">（互为leader）</span></font></div><div><span style="font-size: 10pt; font-family: 黑体;">                </span><span style="font-family: 黑体;"><img src="Kafka_files/Image [8].png" type="image/png" data-filename="Image.png" width="363"/></span></div><ul><ul><ul><li><div><span style="font-size: 11pt;"><span style="font-size: 11pt; color: black; font-family: 华文宋体; font-weight: bold;">副本特性</span><span style="font-size: 11pt; color: black; font-family: 华文宋体;">：</span></span></div></li><ul><li><div><span style="font-size: 11pt;"><span style="font-size: 11pt; color: black; font-family: 华文宋体;">副本以分区为单位。每个分区都有各自的主副本和从副本。</span></span></div></li><li><div><span style="font-size: 11pt; color: black; font-family: 华文宋体;">主副本叫做</span><span style="font-size: 11pt; color: black; font-family: 华文宋体;">Leader</span><span style="font-size: 11pt; color: black; font-family: 华文宋体;">，从副本叫做</span><span style="font-size: 11pt; color: black; font-family: 华文宋体;">Follower</span><span style="font-size: 11pt; color: black; font-family: 华文宋体;">。</span><span style="font-size: 11pt; color: black; font-family: 华文宋体;">Follower</span><span style="font-size: 11pt; color: black; font-family: 华文宋体;">通过拉取的方式从</span><span style="font-size: 11pt; color: black; font-family: 华文宋体;">Leader</span><span style="font-size: 11pt; color: black; font-family: 华文宋体;">中同步数据。</span></div></li><li><div><span style="font-size: 11pt; color: black; font-family: 华文宋体;">消费者和生产者都是从</span><span style="font-size: 11pt; color: black; font-family: 华文宋体;">Leader</span><span style="font-size: 11pt; color: black; font-family: 华文宋体;">中读写数据，不与</span><span style="font-size: 11pt; color: black; font-family: 华文宋体;">Follower</span><span style="font-size: 11pt; color: black; font-family: 华文宋体;">交互。</span></div></li></ul><li><div><span style="font-size: 11pt; color: black; font-family: 华文细黑;">为了提高</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Kafka</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">的</span><span style="font-size: 11pt; color: black; font-family: 华文细黑; font-weight: bold;">容错性</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">，</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Kafka</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">支持</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Partition</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">的复制策略，可以通过配置文件配置</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Partition</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">的副本个数。</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Kafka</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">针对</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Partition</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">的复制同样需要选出一个</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Leader</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">，同时由该</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Leader</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">负责</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Partition</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">的读写操作，其他的副本节点只是负责数据的同步。如果</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Leader</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">失效，那么将会有其他</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">follower</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">来接管</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">(</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">成为新的</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Leader)</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">，如果由于</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Follower</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">自身的性能，或者网络原因导致同步的数据落后</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Leader</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">太多，那么当</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Leader</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">失效后，就不会将这个</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Follower</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">选为</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Leader</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">。由于</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Leader</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">的</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Server</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">承载了全部的请求压力</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">,</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">因此从集群的整体考虑</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">,Kafka</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">会将</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Leader</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">均横的分散在每个实例上，来确保整体的性能稳定。一个</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Kafka</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">集群各个节点间可能互为</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Leader</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">和</span><span style="font-size: 11pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Flower</span><span style="font-size: 11pt; color: black; font-family: 华文细黑;">。</span></div></li></ul></ul></ul><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-family: 黑体; font-weight: bold;">           </span></font></div><div style="margin-left: 40px;"><font style="font-size: 10pt;"><span style="font-size: 10pt; font-family: 黑体; font-weight: bold;">                         </span></font><span style="font-family: 黑体; font-weight: bold;"><img src="Kafka_files/Image [9].png" type="image/png" data-filename="Image.png" width="451"/></span></div><div style="margin-left: 40px;"><span style="font-size: 10pt; font-family: &quot;FrutigerNext LT Regular&quot;;">       <span style="font-size: 10pt; font-family: &quot;FrutigerNext LT Regular&quot;; font-weight: bold;">注：</span></span></div><div style="margin-left: 40px;"><span style="font-size: 10pt; font-family: &quot;FrutigerNext LT Regular&quot;;">       <span style="font-size: 10pt; font-family: &quot;FrutigerNext LT Regular&quot;; color: rgb(121, 121, 121);"> </span><span style="font-size: 10pt; font-family: &quot;FrutigerNext LT Regular&quot;; color: rgb(121, 121, 121);"> </span><span style="font-size: 10pt; font-family: &quot;FrutigerNext LT Regular&quot;; color: rgb(121, 121, 121);">Kafka</span></span><span style="font-size: 10pt; color: rgb(121, 121, 121); font-family: 华文细黑;">中</span><span style="font-size: 10pt; color: rgb(121, 121, 121); font-family: &quot;FrutigerNext LT Regular&quot;;">partition replication</span><span style="font-size: 10pt; color: rgb(121, 121, 121); font-family: 华文细黑;">之间同步数据，从</span><span style="font-size: 10pt; color: rgb(121, 121, 121); font-family: &quot;FrutigerNext LT Regular&quot;;">partition</span><span style="font-size: 10pt; color: rgb(121, 121, 121); font-family: 华文细黑;">的</span><span style="font-size: 10pt; color: rgb(121, 121, 121); font-family: &quot;FrutigerNext LT Regular&quot;;">leader</span><span style="font-size: 10pt; color: rgb(121, 121, 121); font-family: 华文细黑;">复制数据到</span><span style="font-size: 10pt; color: rgb(121, 121, 121); font-family: &quot;FrutigerNext LT Regular&quot;;">follower</span><span style="font-size: 10pt; color: rgb(121, 121, 121); font-family: 华文细黑;">只需要一个线程</span><span style="font-size: 10pt; color: rgb(121, 121, 121); font-family: &quot;FrutigerNext LT Regular&quot;;">(</span><span style="font-size: 10pt; color: rgb(121, 121, 121); font-family: &quot;FrutigerNext LT Regular&quot;;">ReplicaFetcherThread</span><span style="font-size: 10pt; color: rgb(121, 121, 121); font-family: &quot;FrutigerNext LT Regular&quot;;">)</span><span style="font-size: 10pt; color: rgb(121, 121, 121); font-family: 华文细黑;">，实际上复制是</span><span style="font-size: 10pt; color: rgb(121, 121, 121); font-family: &quot;FrutigerNext LT Regular&quot;;">follower(</span><span style="font-size: 10pt; color: rgb(121, 121, 121); font-family: 华文细黑;">一个</span><span style="font-size: 10pt; color: rgb(121, 121, 121); font-family: &quot;FrutigerNext LT Regular&quot;;">follower</span><span style="font-size: 10pt; color: rgb(121, 121, 121); font-family: 华文细黑;">相当于</span><span style="font-size: 10pt; color: rgb(121, 121, 121); font-family: &quot;FrutigerNext LT Regular&quot;;">consumer)</span><span style="font-size: 10pt; color: rgb(121, 121, 121); font-family: 华文细黑;">主动从</span><span style="font-size: 10pt; color: rgb(121, 121, 121); font-family: &quot;FrutigerNext LT Regular&quot;;">leader</span><span style="font-size: 10pt; color: rgb(121, 121, 121); font-family: 华文细黑;">批量拉取消息的，这极大提高了吞吐量。</span></div><div style="margin-left: 40px;"><span style="font-size: 10pt;"><br/></span></div><div><font style="font-size: 16pt;"><span style="font-size: 16pt; color: rgb(127, 127, 127); font-family: 华文细黑; font-weight: bold;">                            </span></font><span style="font-size: 16pt;"><span style="font-size: 16pt; color: rgb(127, 127, 127); font-family: 华文细黑; font-weight: bold;"><img src="Kafka_files/Image [10].png" type="image/png" data-filename="Image.png" width="393"/></span></span></div><div><span style="color: rgb(127, 127, 127); font-family: 华文细黑; font-weight: bold;"><span style="font-size: 16pt; color: rgb(127, 127, 127); font-family: 华文细黑; font-weight: bold;">    </span><span style="font-size: 16pt; color: rgb(127, 127, 127); font-family: 华文细黑; font-weight: bold;">    </span><span style="font-size: 16pt; color: rgb(127, 127, 127); font-family: 华文细黑; font-weight: bold;">    </span><span style="font-size: 16pt; color: rgb(127, 127, 127); font-family: 华文细黑; font-weight: bold;">    </span><span style="font-size: 16pt; color: rgb(127, 127, 127); font-family: 华文细黑; font-weight: bold;">    </span><span style="font-size: 16pt; color: rgb(127, 127, 127); font-family: 华文细黑; font-weight: bold;">       </span> <span style="font-size: 11pt; color: rgb(127, 127, 127); font-family: 华文细黑; font-weight: bold;">注：</span></span></div><ul><ul><ul><ul><ul><li><div><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: &quot;FrutigerNext LT Regular&quot;;">Kafka</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: 华文细黑;">中每个</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: &quot;FrutigerNext LT Regular&quot;;">Broker</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: 华文细黑;">启动时都会创建一个副本管理服务</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: &quot;FrutigerNext LT Regular&quot;;">(</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: &quot;FrutigerNext LT Regular&quot;;">ReplicaManager</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: &quot;FrutigerNext LT Regular&quot;;">)</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: 华文细黑;">，该服务负责维护</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: &quot;FrutigerNext LT Regular&quot;;">ReplicaFetcherThread</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: 华文细黑;">与其他</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: &quot;FrutigerNext LT Regular&quot;;">Broker</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: 华文细黑;">链路连接关系。该</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: &quot;FrutigerNext LT Regular&quot;;">Broker</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: 华文细黑;">中存在的</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: &quot;FrutigerNext LT Regular&quot;;">Follower partitions</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: 华文细黑;">对应的</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: &quot;FrutigerNext LT Regular&quot;;">leader partitions</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: 华文细黑;">分布在不同的</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: &quot;FrutigerNext LT Regular&quot;;">Broker</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: 华文细黑;">上，这些</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: &quot;FrutigerNext LT Regular&quot;;">Broker</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: 华文细黑;">创建相同数量的</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: &quot;FrutigerNext LT Regular&quot;;">ReplicaFetcherThread</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: 华文细黑;">线程同步对应</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: &quot;FrutigerNext LT Regular&quot;;">partition</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: 华文细黑;">数据。</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: &quot;FrutigerNext LT Regular&quot;;">Kafka</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: 华文细黑;">中</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: &quot;FrutigerNext LT Regular&quot;;">partition</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: 华文细黑;">间复制数据是由</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: &quot;FrutigerNext LT Regular&quot;;">follower(</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: 华文细黑;">扮演</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: &quot;FrutigerNext LT Regular&quot;;">consumer</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: 华文细黑;">角色</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: &quot;FrutigerNext LT Regular&quot;;">)</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: 华文细黑;">主动向</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: &quot;FrutigerNext LT Regular&quot;;">leader</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: 华文细黑;">获取消息，</span> <span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: &quot;FrutigerNext LT Regular&quot;;">follower</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: 华文细黑;">每次读取消息都会更新</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: &quot;FrutigerNext LT Regular&quot;;">HW</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: 华文细黑;">状态（</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: &quot;FrutigerNext LT Regular&quot;;">High Watermark</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: 华文细黑;">，用于记录当前最新消息的标识）。每当</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: &quot;FrutigerNext LT Regular&quot;;">Follower</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: 华文细黑;">的</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: &quot;FrutigerNext LT Regular&quot;;">partitions</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: 华文细黑;">发生变更而影响</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: &quot;FrutigerNext LT Regular&quot;;">leader</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: 华文细黑;">所在</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: &quot;FrutigerNext LT Regular&quot;;">Broker</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: 华文细黑;">时，</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: &quot;FrutigerNext LT Regular&quot;;">ReplicaManager</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: 华文细黑;">就会新建或销毁相应的</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: &quot;FrutigerNext LT Regular&quot;;">ReplicaFetcherThread</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: 华文细黑;">。</span></div></li><li><div><font color="#464646" style="font-size: 10pt;"><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: 华文细黑;">简单的说就是，</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: &quot;FrutigerNext LT Regular&quot;;">follower</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: 华文细黑;">启动一线程用于同步</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: &quot;FrutigerNext LT Regular&quot;;">leader</span><span style="font-size: 10pt; color: rgb(70, 70, 70); font-family: 华文细黑;">数据。</span></font></div></li></ul></ul></ul></ul></ul><div><br/></div><div><font style="font-size: 16pt;"><span style="font-size: 16pt; color: rgb(127, 127, 127); font-family: 华文细黑; font-weight: bold;">      </span></font> <font style="font-size: 14pt;"><span style="font-size: 14pt; font-family: &quot;FrutigerNext LT Medium&quot;; font-weight: bold;">Kafka Logs</span></font></div><div><br/></div><div><br/></div><div><span style="font-size: 14pt; font-family: 华文细黑; font-weight: bold;">        </span><span style="font-size: 14pt; font-family: &quot;FrutigerNext LT Medium&quot;; font-weight: bold;">Kafka Log</span> <span style="font-size: 14pt; font-family: &quot;FrutigerNext LT Medium&quot;; font-weight: bold;">Cleanup</span><span style="font-size: 14pt; font-family: 华文细黑; font-weight: bold;">      </span></div><div style="margin-left: 80px;"><font style="font-size: 10pt;"><span style="font-size: 10pt; color: black; font-family: 华文细黑;">简介：</span></font></div><div style="margin-left: 120px;"><span style="font-size: 10pt; color: black; font-family: 华文细黑;">日志的清理方式有两种：</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">delete</span> <span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">和</span> <span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">compact</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">。</span></div><div style="margin-left: 120px;"><font style="font-size: 10pt;"><span style="font-size: 10pt; color: black; font-family: 华文细黑;">删除</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">的阈值有两种：过期的时间和分区内总日志大小</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">。</span></font></div><div style="margin-left: 120px;"></div><div style="margin-left: 80px;"><span style="font-weight: bold;">compact：</span></div><div style="margin-left: 120px;"><font style="font-size: 10pt;"><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">        Compact</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">的清理方式是指至少保留每个</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">key</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">值最新的</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">value</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">消息。例如：一条消息包含</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Key</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">和</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Value</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">两个内容，</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Key</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">为</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">K1</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">的有</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">3</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">条消息，其值分别为</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">V1</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">、</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">V3</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">、</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">V4</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">，则采用</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">Compact</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">的清理方式时，只保留最新的那条消息，即值为</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">V4</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">的消息。（如何判断哪条消息为最新消息，因为消息是顺序存储的，</span><span style="font-size: 10pt; color: black; font-family: &quot;FrutigerNext LT Regular&quot;;">offset</span><span style="font-size: 10pt; color: black; font-family: 华文细黑;">大的即为后存入的、最新的消息）。</span></font></div><div style="margin-left: 120px;"><font style="font-size: 10pt;"><span style="font-size: 10pt; color: black; font-family: 华文细黑; font-weight: bold;">简单的说：只保留最新版数据。</span></font></div><div style="margin-left: 80px;"></div><div><span style="font-size: 14pt;"><br/></span></div><div style="margin-left: 40px;"><span style="font-size: 14pt; font-family: 华文细黑; font-weight: bold;">                </span><span style="font-size: 14pt;"><span style="font-size: 14pt; font-family: 华文细黑; font-weight: bold;"><img src="Kafka_files/Image [11].png" type="image/png" data-filename="Image.png" width="300"/></span></span></div><div><span style="font-size: 14pt;"><br/></span></div><div><span style="font-size: 16pt; color: rgb(127, 127, 127); font-family: 华文细黑; font-weight: bold;">      </span> <font style="font-size: 14pt;"><span style="font-size: 14pt; font-family: &quot;FrutigerNext LT Medium&quot;; font-weight: bold;">Kafka Message</span></font><span style="font-size: 14pt; font-family: 华文细黑; font-weight: bold;">   </span></div><div>           <font style="font-size: 12pt;"><b>      <span style="font-family: &quot;FrutigerNext LT Medium&quot;;">Kafka</span><span style="font-family: 黑体;">消息传输：（不太懂这个表）</span></b></font><br/></div><div><font style="font-size: 12pt;"><b><span style="font-family: 黑体;"><span>    </span><span>    </span><span>    </span><span>    </span></span></b></font><span style="font-size: 12pt; font-family: 黑体;"><b><img src="Kafka_files/Image [12].png" type="image/png" data-filename="Image.png" width="502"/></b></span></div><ul><ul><ul><li><div><span style="font-size: 11.0pt; font-family: 华文细黑; mso-ascii-font-family: &quot;FrutigerNext LT Regular&quot;; mso-fareast-font-family: 华文细黑; mso-bidi-font-family: +mn-cs; mso-bidi-theme-font: minor-bidi; color: black; mso-color-index: 1; mso-font-kerning: 12.0pt; language: zh-CN; mso-style-textfill-type: solid; mso-style-textfill-fill-themecolor: text1; mso-style-textfill-fill-color: black; mso-style-textfill-fill-alpha: 100.0%;">同步发送：</span><span style="font-size: 11.0pt; font-family: &quot;FrutigerNext LT Regular&quot;; mso-ascii-font-family: &quot;FrutigerNext LT Regular&quot;; mso-fareast-font-family: 华文细黑; mso-bidi-font-family: +mn-cs; mso-bidi-theme-font: minor-bidi; color: black; mso-color-index: 1; mso-font-kerning: 12.0pt; language: en-US; mso-style-textfill-type: solid; mso-style-textfill-fill-themecolor: text1; mso-style-textfill-fill-color: black; mso-style-textfill-fill-alpha: 100.0%;">client</span><span style="font-size: 11.0pt; font-family: 华文细黑; mso-ascii-font-family: &quot;FrutigerNext LT Regular&quot;; mso-fareast-font-family: 华文细黑; mso-bidi-font-family: +mn-cs; mso-bidi-theme-font: minor-bidi; color: black; mso-color-index: 1; mso-font-kerning: 12.0pt; language: zh-CN; mso-style-textfill-type: solid; mso-style-textfill-fill-themecolor: text1; mso-style-textfill-fill-color: black; mso-style-textfill-fill-alpha: 100.0%;">每写一条，发送一条到</span><span style="font-size: 11.0pt; font-family: &quot;FrutigerNext LT Regular&quot;; mso-ascii-font-family: &quot;FrutigerNext LT Regular&quot;; mso-fareast-font-family: 华文细黑; mso-bidi-font-family: +mn-cs; mso-bidi-theme-font: minor-bidi; color: black; mso-color-index: 1; mso-font-kerning: 12.0pt; language: en-US; mso-style-textfill-type: solid; mso-style-textfill-fill-themecolor: text1; mso-style-textfill-fill-color: black; mso-style-textfill-fill-alpha: 100.0%;">broker</span><span style="font-size: 11.0pt; font-family: 华文细黑; mso-ascii-font-family: &quot;FrutigerNext LT Regular&quot;; mso-fareast-font-family: 华文细黑; mso-bidi-font-family: +mn-cs; mso-bidi-theme-font: minor-bidi; color: black; mso-color-index: 1; mso-font-kerning: 12.0pt; language: zh-CN; mso-style-textfill-type: solid; mso-style-textfill-fill-themecolor: text1; mso-style-textfill-fill-color: black; mso-style-textfill-fill-alpha: 100.0%;">。可靠性高，常用。</span></div></li><li><div><span style="font-size: 11.0pt; font-family: 华文细黑; mso-ascii-font-family: &quot;FrutigerNext LT Regular&quot;; mso-fareast-font-family: 华文细黑; mso-bidi-font-family: +mn-cs; mso-bidi-theme-font: minor-bidi; color: black; mso-color-index: 1; mso-font-kerning: 12.0pt; language: zh-CN; mso-style-textfill-type: solid; mso-style-textfill-fill-themecolor: text1; mso-style-textfill-fill-color: black; mso-style-textfill-fill-alpha: 100.0%;">异步发送：</span><span style="font-size: 11.0pt; font-family: &quot;FrutigerNext LT Regular&quot;; mso-ascii-font-family: &quot;FrutigerNext LT Regular&quot;; mso-fareast-font-family: 华文细黑; mso-bidi-font-family: +mn-cs; mso-bidi-theme-font: minor-bidi; color: black; mso-color-index: 1; mso-font-kerning: 12.0pt; language: en-US; mso-style-textfill-type: solid; mso-style-textfill-fill-themecolor: text1; mso-style-textfill-fill-color: black; mso-style-textfill-fill-alpha: 100.0%;">client</span><span style="font-size: 11.0pt; font-family: 华文细黑; mso-ascii-font-family: &quot;FrutigerNext LT Regular&quot;; mso-fareast-font-family: 华文细黑; mso-bidi-font-family: +mn-cs; mso-bidi-theme-font: minor-bidi; color: black; mso-color-index: 1; mso-font-kerning: 12.0pt; language: zh-CN; mso-style-textfill-type: solid; mso-style-textfill-fill-themecolor: text1; mso-style-textfill-fill-color: black; mso-style-textfill-fill-alpha: 100.0%;">先将数据写入一</span><span style="font-size: 11.0pt; font-family: &quot;FrutigerNext LT Regular&quot;; mso-ascii-font-family: &quot;FrutigerNext LT Regular&quot;; mso-fareast-font-family: 华文细黑; mso-bidi-font-family: +mn-cs; mso-bidi-theme-font: minor-bidi; color: black; mso-color-index: 1; mso-font-kerning: 12.0pt; language: en-US; mso-style-textfill-type: solid; mso-style-textfill-fill-themecolor: text1; mso-style-textfill-fill-color: black; mso-style-textfill-fill-alpha: 100.0%;">buffer</span><span style="font-size: 11.0pt; font-family: 华文细黑; mso-ascii-font-family: &quot;FrutigerNext LT Regular&quot;; mso-fareast-font-family: 华文细黑; mso-bidi-font-family: +mn-cs; mso-bidi-theme-font: minor-bidi; color: black; mso-color-index: 1; mso-font-kerning: 12.0pt; language: zh-CN; mso-style-textfill-type: solid; mso-style-textfill-fill-themecolor: text1; mso-style-textfill-fill-color: black; mso-style-textfill-fill-alpha: 100.0%;">，待写入达到一定条数后，将</span><span style="font-size: 11.0pt; font-family: &quot;FrutigerNext LT Regular&quot;; mso-ascii-font-family: &quot;FrutigerNext LT Regular&quot;; mso-fareast-font-family: 华文细黑; mso-bidi-font-family: +mn-cs; mso-bidi-theme-font: minor-bidi; color: black; mso-color-index: 1; mso-font-kerning: 12.0pt; language: en-US; mso-style-textfill-type: solid; mso-style-textfill-fill-themecolor: text1; mso-style-textfill-fill-color: black; mso-style-textfill-fill-alpha: 100.0%;">buffer</span><span style="font-size: 11.0pt; font-family: 华文细黑; mso-ascii-font-family: &quot;FrutigerNext LT Regular&quot;; mso-fareast-font-family: 华文细黑; mso-bidi-font-family: +mn-cs; mso-bidi-theme-font: minor-bidi; color: black; mso-color-index: 1; mso-font-kerning: 12.0pt; language: zh-CN; mso-style-textfill-type: solid; mso-style-textfill-fill-themecolor: text1; mso-style-textfill-fill-color: black; mso-style-textfill-fill-alpha: 100.0%;">内数据一次性发送到</span><span style="font-size: 11.0pt; font-family: &quot;FrutigerNext LT Regular&quot;; mso-ascii-font-family: &quot;FrutigerNext LT Regular&quot;; mso-fareast-font-family: 华文细黑; mso-bidi-font-family: +mn-cs; mso-bidi-theme-font: minor-bidi; color: black; mso-color-index: 1; mso-font-kerning: 12.0pt; language: en-US; mso-style-textfill-type: solid; mso-style-textfill-fill-themecolor: text1; mso-style-textfill-fill-color: black; mso-style-textfill-fill-alpha: 100.0%;">broker</span><span style="font-size: 11.0pt; font-family: 华文细黑; mso-ascii-font-family: &quot;FrutigerNext LT Regular&quot;; mso-fareast-font-family: 华文细黑; mso-bidi-font-family: +mn-cs; mso-bidi-theme-font: minor-bidi; color: black; mso-color-index: 1; mso-font-kerning: 12.0pt; language: zh-CN; mso-style-textfill-type: solid; mso-style-textfill-fill-themecolor: text1; mso-style-textfill-fill-color: black; mso-style-textfill-fill-alpha: 100.0%;">。容易造成数据丢失，一般不用。</span></div></li><li><div><span style="font-size: 11.0pt; font-family: 华文细黑; mso-ascii-font-family: &quot;FrutigerNext LT Regular&quot;; mso-fareast-font-family: 华文细黑; mso-bidi-font-family: +mn-cs; mso-bidi-theme-font: minor-bidi; color: black; mso-color-index: 1; mso-font-kerning: 12.0pt; language: zh-CN; mso-style-textfill-type: solid; mso-style-textfill-fill-themecolor: text1; mso-style-textfill-fill-color: black; mso-style-textfill-fill-alpha: 100.0%;">同步复制、异步复制与同步发送、异步发送原理相同。常用同步发送带确认</span><span style="font-size: 11.0pt; font-family: &quot;FrutigerNext LT Regular&quot;; mso-ascii-font-family: &quot;FrutigerNext LT Regular&quot;; mso-fareast-font-family: 华文细黑; mso-bidi-font-family: +mn-cs; mso-bidi-theme-font: minor-bidi; color: black; mso-color-index: 1; mso-font-kerning: 12.0pt; language: en-US; mso-style-textfill-type: solid; mso-style-textfill-fill-themecolor: text1; mso-style-textfill-fill-color: black; mso-style-textfill-fill-alpha: 100.0%;">+</span><span style="font-size: 11.0pt; font-family: 华文细黑; mso-ascii-font-family: &quot;FrutigerNext LT Regular&quot;; mso-fareast-font-family: 华文细黑; mso-bidi-font-family: +mn-cs; mso-bidi-theme-font: minor-bidi; color: black; mso-color-index: 1; mso-font-kerning: 12.0pt; language: zh-CN; mso-style-textfill-type: solid; mso-style-textfill-fill-themecolor: text1; mso-style-textfill-fill-color: black; mso-style-textfill-fill-alpha: 100.0%;">同步复制。</span></div></li></ul></ul></ul><div><font style="font-size: 14pt;"><b><span>    </span><span>    </span> <span style="font-family: &quot;FrutigerNext LT Medium&quot;;">Kafka Cluster Mirroring</span></b></font><br/></div><div><span style="font-size: 14pt; font-family: &quot;FrutigerNext LT Medium&quot;;"><b><span><span>    </span><span>    </span><span>    </span> </span><img src="Kafka_files/Image [13].png" type="image/png" data-filename="Image.png" width="379"/></b></span></div><div><span style="font-family: &quot;FrutigerNext LT Medium&quot;;"><span style="font-weight: bold; font-size: 14pt;">    </span><span style="font-weight: bold; font-size: 14pt;">    </span><span style="font-weight: bold; font-size: 14pt;">     </span> <font style="font-size: 11pt;">  注：</font></span></div><ul><ul><ul><li><div><font color="#464646" style="font-size: 10pt;"><span style="font-family: &quot;FrutigerNext LT Regular&quot;;">Kafka Cluster Mirroring</span><span style="font-family: 华文细黑;">是</span><span style="font-family: &quot;FrutigerNext LT Regular&quot;;">Kafka</span><span style="font-family: 华文细黑;">跨集群数据同步方案，通过</span><span style="font-family: &quot;FrutigerNext LT Regular&quot;;">Kafka</span><span style="font-family: 华文细黑;">内置的</span><span style="font-family: &quot;FrutigerNext LT Regular&quot;;">MirrorMaker</span><span style="font-family: 华文细黑;">工具来实现。</span></font></div></li><li><div><font style="font-size: 10pt; color: rgb(70, 70, 70);"><span style="font-family: 华文细黑;">图中展示了如何从源</span><span style="font-family: &quot;FrutigerNext LT Regular&quot;;">Kafka</span><span style="font-family: 华文细黑;">集群（</span><span style="font-family: &quot;FrutigerNext LT Regular&quot;;">Source Cluster</span><span style="font-family: 华文细黑;">）到目标</span><span style="font-family: &quot;FrutigerNext LT Regular&quot;;">Kafka</span><span style="font-family: 华文细黑;">集群</span><span style="font-family: &quot;FrutigerNext LT Regular&quot;;">(Target Cluster)</span><span style="font-family: 华文细黑;">同步数据，即通过</span><span style="font-family: &quot;FrutigerNext LT Regular&quot;;">MirrorMaker</span><span style="font-family: 华文细黑;">工具中的</span><span style="font-family: &quot;FrutigerNext LT Regular&quot;;">Consumer</span><span style="font-family: 华文细黑;">从源集群消费数据，然后再通过内置的</span><span style="font-family: &quot;FrutigerNext LT Regular&quot;;">Producer</span><span style="font-family: 华文细黑;">将数据重新发送到目标集群。</span></font></div></li></ul></ul></ul><div><span style="font-size: 14pt; font-family: 华文细黑; font-weight: bold;">      </span> <span style="font-size: 14pt; font-family: 华文细黑; font-weight: bold;"> </span><span style="font-size: 14pt; font-family: 华文细黑; font-weight: bold;"> </span><span style="font-size: 16pt; color: rgb(127, 127, 127); font-family: 华文细黑; font-weight: bold;"> </span></div><div><font style="font-size: 16pt;"><span style="font-size: 16pt; font-family: &quot;FrutigerNext LT Regular&quot;; font-weight: bold;">Kafka</span><span style="font-size: 16pt; font-family: 华文细黑; font-weight: bold;">关键流程</span></font></div><div><font style="font-size: 14pt;"><b><font><span style="font-family: 华文细黑;">   <font color="#464646"> </font></span></font> <font color="#464646"><span style="font-family: &quot;FrutigerNext LT Medium&quot;;">Producer</span><span style="font-family: 黑体;">写数据</span></font></b></font></div><ul><li><div><span style="font-size: 11.0pt; font-family: 华文细黑; mso-ascii-font-family: &quot;FrutigerNext LT Regular&quot;; mso-fareast-font-family: 华文细黑; mso-bidi-font-family: +mn-cs; mso-bidi-theme-font: minor-bidi; color: black; mso-color-index: 1; mso-font-kerning: 12.0pt; language: zh-CN; mso-style-textfill-type: solid; mso-style-textfill-fill-themecolor: text1; mso-style-textfill-fill-color: black; mso-style-textfill-fill-alpha: 100.0%;">总体流程</span><img src="Kafka_files/Image [14].png" type="image/png" data-filename="Image.png" width="257"/></div></li><ul><li><div><span style="font-size: 11.0pt; font-family: &quot;FrutigerNext LT Regular&quot;; mso-ascii-font-family: &quot;FrutigerNext LT Regular&quot;; mso-fareast-font-family: 华文细黑; mso-bidi-font-family: +mn-cs; mso-bidi-theme-font: minor-bidi; color: black; mso-color-index: 1; mso-font-kerning: 12.0pt; language: en-US; mso-style-textfill-type: solid; mso-style-textfill-fill-themecolor: text1; mso-style-textfill-fill-color: black; mso-style-textfill-fill-alpha: 100.0%;">Producer</span><span style="font-size: 11.0pt; font-family: 华文细黑; mso-ascii-font-family: &quot;FrutigerNext LT Regular&quot;; mso-fareast-font-family: 华文细黑; mso-bidi-font-family: +mn-cs; mso-bidi-theme-font: minor-bidi; color: black; mso-color-index: 1; mso-font-kerning: 12.0pt; language: zh-CN; mso-style-textfill-type: solid; mso-style-textfill-fill-themecolor: text1; mso-style-textfill-fill-color: black; mso-style-textfill-fill-alpha: 100.0%;">连接任意存活的</span><span style="font-size: 11.0pt; font-family: &quot;FrutigerNext LT Regular&quot;; mso-ascii-font-family: &quot;FrutigerNext LT Regular&quot;; mso-fareast-font-family: 华文细黑; mso-bidi-font-family: +mn-cs; mso-bidi-theme-font: minor-bidi; color: black; mso-color-index: 1; mso-font-kerning: 12.0pt; language: en-US; mso-style-textfill-type: solid; mso-style-textfill-fill-themecolor: text1; mso-style-textfill-fill-color: black; mso-style-textfill-fill-alpha: 100.0%;">Broker</span><span style="font-size: 11.0pt; font-family: 华文细黑; mso-ascii-font-family: &quot;FrutigerNext LT Regular&quot;; mso-fareast-font-family: 华文细黑; mso-bidi-font-family: +mn-cs; mso-bidi-theme-font: minor-bidi; color: black; mso-color-index: 1; mso-font-kerning: 12.0pt; language: zh-CN; mso-style-textfill-type: solid; mso-style-textfill-fill-themecolor: text1; mso-style-textfill-fill-color: black; mso-style-textfill-fill-alpha: 100.0%;">，请求制定</span><span style="font-size: 11.0pt; font-family: &quot;FrutigerNext LT Regular&quot;; mso-ascii-font-family: &quot;FrutigerNext LT Regular&quot;; mso-fareast-font-family: 华文细黑; mso-bidi-font-family: +mn-cs; mso-bidi-theme-font: minor-bidi; color: black; mso-color-index: 1; mso-font-kerning: 12.0pt; language: en-US; mso-style-textfill-type: solid; mso-style-textfill-fill-themecolor: text1; mso-style-textfill-fill-color: black; mso-style-textfill-fill-alpha: 100.0%;">Topic</span><span style="font-size: 11.0pt; font-family: 华文细黑; mso-ascii-font-family: &quot;FrutigerNext LT Regular&quot;; mso-fareast-font-family: 华文细黑; mso-bidi-font-family: +mn-cs; mso-bidi-theme-font: minor-bidi; color: black; mso-color-index: 1; mso-font-kerning: 12.0pt; language: zh-CN; mso-style-textfill-type: solid; mso-style-textfill-fill-themecolor: text1; mso-style-textfill-fill-color: black; mso-style-textfill-fill-alpha: 100.0%;">、</span><span style="font-size: 11.0pt; font-family: &quot;FrutigerNext LT Regular&quot;; mso-ascii-font-family: &quot;FrutigerNext LT Regular&quot;; mso-fareast-font-family: 华文细黑; mso-bidi-font-family: +mn-cs; mso-bidi-theme-font: minor-bidi; color: black; mso-color-index: 1; mso-font-kerning: 12.0pt; language: en-US; mso-style-textfill-type: solid; mso-style-textfill-fill-themecolor: text1; mso-style-textfill-fill-color: black; mso-style-textfill-fill-alpha: 100.0%;">Partition</span><span style="font-size: 11.0pt; font-family: 华文细黑; mso-ascii-font-family: &quot;FrutigerNext LT Regular&quot;; mso-fareast-font-family: 华文细黑; mso-bidi-font-family: +mn-cs; mso-bidi-theme-font: minor-bidi; color: black; mso-color-index: 1; mso-font-kerning: 12.0pt; language: zh-CN; mso-style-textfill-type: solid; mso-style-textfill-fill-themecolor: text1; mso-style-textfill-fill-color: black; mso-style-textfill-fill-alpha: 100.0%;">的</span><span style="font-size: 11.0pt; font-family: &quot;FrutigerNext LT Regular&quot;; mso-ascii-font-family: &quot;FrutigerNext LT Regular&quot;; mso-fareast-font-family: 华文细黑; mso-bidi-font-family: +mn-cs; mso-bidi-theme-font: minor-bidi; color: black; mso-color-index: 1; mso-font-kerning: 12.0pt; language: en-US; mso-style-textfill-type: solid; mso-style-textfill-fill-themecolor: text1; mso-style-textfill-fill-color: black; mso-style-textfill-fill-alpha: 100.0%;">Leader</span><span style="font-size: 11.0pt; font-family: 华文细黑; mso-ascii-font-family: &quot;FrutigerNext LT Regular&quot;; mso-fareast-font-family: 华文细黑; mso-bidi-font-family: +mn-cs; mso-bidi-theme-font: minor-bidi; color: black; mso-color-index: 1; mso-font-kerning: 12.0pt; language: zh-CN; mso-style-textfill-type: solid; mso-style-textfill-fill-themecolor: text1; mso-style-textfill-fill-color: black; mso-style-textfill-fill-alpha: 100.0%;">元数据信息，然后直接与对应的</span><span style="font-size: 11.0pt; font-family: &quot;FrutigerNext LT Regular&quot;; mso-ascii-font-family: &quot;FrutigerNext LT Regular&quot;; mso-fareast-font-family: 华文细黑; mso-bidi-font-family: +mn-cs; mso-bidi-theme-font: minor-bidi; color: black; mso-color-index: 1; mso-font-kerning: 12.0pt; language: en-US; mso-style-textfill-type: solid; mso-style-textfill-fill-themecolor: text1; mso-style-textfill-fill-color: black; mso-style-textfill-fill-alpha: 100.0%;">Broker</span><span style="font-size: 11.0pt; font-family: 华文细黑; mso-ascii-font-family: &quot;FrutigerNext LT Regular&quot;; mso-fareast-font-family: 华文细黑; mso-bidi-font-family: +mn-cs; mso-bidi-theme-font: minor-bidi; color: black; mso-color-index: 1; mso-font-kerning: 12.0pt; language: zh-CN; mso-style-textfill-type: solid; mso-style-textfill-fill-themecolor: text1; mso-style-textfill-fill-color: black; mso-style-textfill-fill-alpha: 100.0%;">直接连接，发布数据。</span></div></li></ul></ul><div><span>       <b><font style="font-size: 14pt;"> </font><font style="font-size: 14pt;"> </font></b></span> <font style="font-size: 14pt;"><b><span style="font-family: &quot;FrutigerNext LT Medium&quot;;">Consumer</span><span style="font-family: 黑体;">读数据</span></b></font></div></div><div><font style="font-size: 14pt;"><b><span style="font-family: 黑体;"><span>    </span><span>    </span><span>    </span></span></b></font><span style="font-size: 14pt; font-family: 黑体;"><b><img src="Kafka_files/Image [15].png" type="image/png" data-filename="Image.png" width="233"/></b></span></div><ul><ul><li><div><span style="font-family: 华文细黑; color: black;"><font style="font-size: 10pt;">总体流程：</font></span></div></li><ul><li><div><font style="font-size: 10pt;"><span style="font-family: &quot;FrutigerNext LT Regular&quot;; color: black;">Consumer</span><span style="font-family: 华文细黑; color: black;">连接指定</span><span style="font-family: &quot;FrutigerNext LT Regular&quot;; color: black;">TopicPartition</span><span style="font-family: 华文细黑; color: black;">所在的</span><span style="font-family: &quot;FrutigerNext LT Regular&quot;; color: black;">LeaderBroker</span><span style="font-family: 华文细黑; color: black;">，用主动获取方式从</span><span style="font-family: &quot;FrutigerNext LT Regular&quot;; color: black;">Kafka</span><span style="font-family: 华文细黑; color: black;">中获取消息。</span></font></div></li></ul></ul></ul><div><span><span>    </span><span>    </span><span>    </span><br/></span></div><div><br/></div></div></span>
</div>
<a href="../HD_index.html">返回首页</a>
</body></html> 